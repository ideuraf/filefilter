<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>filefilter</title>
</head>
<body>
    <h2>filefilter</h2>
    <input type="file" id="folderInput" webkitdirectory directory multiple>
    <br><br>
    <input type="text" id="fileType" placeholder="file type">
    <br><br>
    <button onclick="processFiles()">filter</button>
    <br><br>
    <span id="result"></span>

    <script>
        async function processFiles() {
            const folderInput = document.getElementById('folderInput');
            const fileTypeInput = document.getElementById('fileType').value.toLowerCase();
            if (!folderInput.files.length) {
                alert('select a folder');
                return;
            }
            if (!fileTypeInput) {
                alert('enter file type');
                return;
            }
            const matchingFiles = Array.from(folderInput.files).filter(file => 
                file.name.toLowerCase().endsWith('.' + fileTypeInput)
            );
            if (matchingFiles.length === 0) {
                alert('no files were found');
                return;
            }
            const zip = new JSZip();
            matchingFiles.forEach(file => {
                zip.file(file.name, file);
            });
            try {
                const content = await zip.generateAsync({type: "blob"});
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(content);
                downloadLink.download = `filtered_files.zip`;
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                document.getElementById('result').textContent = `${matchingFiles.length} files downloaded.`;
            } catch (error) {
                document.getElementById('result').textContent = `error creating zip file: ${error}`;
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</body>
</html>
